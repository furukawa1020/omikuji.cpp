#include <iostream>
#include <vector>
#include <thread>
#include <chrono>
#include <ctime>
#include <cstdlib>

using namespace std;
using namespace chrono;

void sleep(int ms) {
    this_thread::sleep_for(milliseconds(ms));
}

void clear() {
    cout << "\033[2J\033[1;1H";
}

void beep() {
    cout << "\a" << flush;
}

// ã‚²ãƒ¼ãƒŸãƒ³ã‚°æ–‡å­—ï¼ˆè‰²ãŒæµã‚Œã‚‹ï¼‰
void rainbow(const string& text) {
    vector<int> colors = {31, 33, 32, 36, 34, 35};
    for (int i = 0; i < text.size(); i++) {
        cout << "\033[1;" << colors[i % colors.size()] << "m"
             << text[i] << "\033[0m";
        sleep(20);
    }
    cout << endl;
}

int main() {
    srand(time(nullptr));

    clear();
    cout << "èµ·å‹•ä¸­";
    for (int i = 0; i < 5; i++) {
        cout << ".";
        beep();
        cout.flush();
        sleep(300);
    }

    clear();

    cout << R"(
        â›©  â›©  â›©
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        å¹´ è¶Š ç¥ ç¤¾
      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    )" << endl;

    sleep(800);
    cout << "ãŠã¿ãã˜ç®±ã‚’æŒ¯ã£ã¦ã„ã¾ã™" << endl;

    vector<string> drum = {"â—", "â—“", "â—‘", "â—’"};
    for (int i = 0; i < 25; i++) {
        cout << "\r\033[1;36m" << drum[i % drum.size()]
             << " ã‚¬ãƒ©ã‚¬ãƒ©â€¦\033[0m" << flush;
        beep();
        sleep(100);
    }

    struct Omikuji {
        string name;
        string message;
        int exit_code;
    };

    vector<Omikuji> fortunes = {
        {"å¤§å‰", "ä¸–ç•Œã¯ã¾ã ã¾ã é¢ç™½ããªã‚‹", 0},
        {"è¶…å‰", "å…¨éƒ¨ã¤ãªãŒã£ã¦å¾Œã§åŠ¹ã", 0},
        {"ç¥å‰", "ä»Šå¹´ã¯å½“ãŸã‚Šå¹´ç¢ºå®š", 0},
        {"è¦‡å‰", "èª¿å­ã«ä¹—ã£ã¦ã‚ˆã„", 0},
        {"å¼·å‰", "é€²ã‚ã€‚æ­¢ã¾ã‚‹ç†ç”±ãªã—", 0},
        {"å‡¶",   "ä»Šæ—¥ã¯ç„¡ç†ã™ã‚‹ãªã€‚å¯ã‚", 1}
    };

    Omikuji result = fortunes[rand() % fortunes.size()];

    clear();

    cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" << endl;
    rainbow("ğŸ  ãŠ ã¿ ã ã˜  ğŸ");
    cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" << endl << endl;

    cout << "\033[1;33mé‹å‹¢ï¼šã€ " << result.name << " ã€‘\033[0m\n\n";
    rainbow(result.message);

    if (result.name != "å‡¶") {
        cout << "\n\033[1;32mâœ¨âœ¨âœ¨ BLESSING âœ¨âœ¨âœ¨\033[0m\n";
        for (int i = 0; i < 5; i++) beep();
    } else {
        cout << "\n\033[1;31mâš  SYSTEM WARNING âš \033[0m\n";
    }

    cout << "\nå¼•ã„ãŸæ™‚åˆ»: " << time(nullptr) << endl;
    cout << "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" << endl;

    return result.exit_code;
}
